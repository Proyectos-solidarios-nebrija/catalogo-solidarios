---
import BlogLayout from '@layouts/BlogLayout.astro'
import { getProjects } from 'src/services/cms'
import { getEnv } from 'src/helpers/getEnv'

const { CMS_URL } = getEnv()

export async function getStaticPaths() {
  const { docs: projects } = await getProjects()

  const paths = projects.map((project) => ({
    params: { slug: project.slug },
    props: project
  }))

  return paths
}

const { name, date_start, date_end, article_html, project_image, web_link } =
  Astro.props
const { url, height, width } = project_image
---

<BlogLayout
  title={name}
  dateStart={new Date(date_start)}
  dateEnd={new Date(date_end)}
  webLink={web_link}
  img={{
    src: CMS_URL + url,
    height: height,
    width: width
  }}>
  <Fragment set:html={article_html} />
</BlogLayout>
