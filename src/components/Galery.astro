---
import { getLangFromUrl, useTranslations } from 'src/i18n/utils'
import test from '@images/galery/test.jpg'
import { Image } from 'astro:assets'
import 'photoswipe/style.css'

const currentLang = getLangFromUrl(Astro.url)
const t = useTranslations(currentLang)

// const images = import.meta.glob<{ default: ImageMetadata }>(
//   '/src/images/galery/**/*.{png,jpg,jpeg}'
// )
---

<section class="content">
  <h2 id={t('nav.galery')}>{t('nav.galery')}</h2>
  <div id="photos">
    {
      Array.from({ length: 100 }).map((_, idx) => (
        <a href={test.src} class={idx % 8 < 4 ? '' : 'reverse'}>
          <Image src={test} alt="smth" />
        </a>
      ))
    }
  </div>
</section>

<style>
  section {
    margin-top: 150px;
  }

  h2 {
    font-size: 8rem;
    font-weight: 400;
    text-align: center;
    margin: 0;
  }

  img {
    object-fit: cover;
    border-radius: 15px;
    height: 100%;
    width: 100%;
  }

  #photos {
    grid-auto-flow: column;
    gap: 20px;
    margin-top: 100px;
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    grid-auto-rows: 140px;
  }

  a:nth-child(2n) {
    width: auto;
    height: 140px;
    grid-column: 7 / span 2;
  }
  a:nth-child(4n) {
    width: auto;
    height: 140px;
    grid-column: 7 / 11;
  }

  a:nth-child(2n + 1) {
    width: auto;
    height: 140px;
    grid-column: 9 / span 2;
  }

  a:nth-child(1),
  a:nth-child(4n + 1) {
    height: 300px;
    width: auto;
    grid-column: 1 / span 6;
    grid-row: span 2;
  }

  .reverse:nth-child(2n) {
    grid-column: 1 / span 2;
  }

  .reverse:nth-child(4n) {
    grid-column: 1 / span 4;
  }

  .reverse:nth-child(2n + 1) {
    grid-column: 3 / span 2;
  }

  .reverse:nth-child(1),
  .reverse:nth-child(4n + 1) {
    height: 300px;
    grid-row: span 2;
    grid-column: 5 / span 6;
  }

  a:nth-last-child(1):nth-child(odd) {
    width: auto;
    height: 300px;
    grid-column: 1 / 11;
  }
</style>

<script>
  import PhotoSwipeLightbox from 'photoswipe/lightbox'

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#photos',
    children: 'a',
    pswpModule: () => import('photoswipe')
  })
  lightbox.init()
</script>
